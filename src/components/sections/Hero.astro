---
import { basics } from '@cv'
import Section from '@/components/Section.astro'
import { Icon } from 'astro-icon/components'
import Skills from './Skills.astro' 

const { name, label, image, location, email } = basics
const { city, region } = location
---

<Section className={Astro.props.className}>
  <div class="flex flex-col gap-8 md:flex-row">
    
    {/* --- LEFT COLUMN (Sidebar) --- */}
    <div class="flex flex-col gap-4 md:w-[320px] shrink-0 md:sticky md:top-8 h-fit">
        
        {/* 1. Profile Card */}
        <div class="flex flex-col gap-4 rounded-3xl bg-skin-muted sm:bg-skin-button-muted p-5 border border-skin-muted/20 shadow-lg shadow-skin-hue/5">
          <div class="flex items-center gap-4">
            <figure class='print:hidden shrink-0'>
              <img
                class='aspect-square w-24 rounded-2xl bg-cover grayscale hover:grayscale-0 transition-all duration-500'
                src={image}
                alt={`Profile of ${name}`}
                loading='eager' />
            </figure>
            <div class="flex flex-col">
              <h1 class="text-2xl font-bold font-mono text-skin-base">{name}</h1>
              <span class="text-skin-accent font-mono text-xs mt-1">{label}</span>
            </div>
          </div>
          
          <div class='flex flex-col gap-2 text-xs text-skin-muted font-mono mt-2'>
            <div class="flex items-center gap-2">
                 <Icon name='globe' width={14} height={14} />
                 {city}, {region}
            </div>
            <div class="flex items-center gap-2">
                 <span class="text-skin-accent">@</span>
                 <a href={`mailto:${email}`} class="hover:text-skin-base transition-colors">{email}</a>
            </div>
          </div>
        </div>

        {/* 2. Social Links (Fixed: Separated into two distinct buttons) */}
        <div class="flex gap-4">
            {basics.profiles.map(({network, url, icon, color}) => (
                <a 
                    href={url} 
                    target="_blank" 
                    class="flex-1 flex justify-center p-3 rounded-3xl bg-skin-muted sm:bg-skin-button-muted hover:bg-skin-button-accent/10 transition-all group border border-skin-muted/20" 
                    aria-label={network}
                >
                    <Icon name={icon} width={20} height={20} class="text-skin-muted group-hover:text-skin-accent transition-colors" />
                </a>
            ))}
        </div>

        {/* 3. COMMAND PALETTE BUTTON (Activates command palette) */}
        <button 
            onclick="const ninja = document.querySelector('ninja-keys'); if (ninja) { ninja.open(); }"
            class="flex items-center justify-between gap-2 rounded-3xl bg-skin-button-muted p-3 hover:bg-skin-button-accent hover:text-skin-inverted transition-all group border border-skin-muted/20 text-skin-base cursor-pointer w-full"
        >
            <div class="flex items-center gap-2">
                <Icon name='command' class='w-5 h-5'/>
                <span class="font-mono font-bold text-sm">Command Palette</span>
            </div>
            <span class="text-xs font-mono opacity-50 border border-skin-muted/50 rounded px-1">Ctrl+K</span>
        </button>

        {/* 4. Neovim Mode Link (Fix: Icon and path) */}
        <a href="/neovim" class="flex items-center justify-center gap-2 rounded-3xl bg-skin-button-muted p-3 hover:bg-skin-button-accent hover:text-skin-inverted transition-all group border border-skin-muted/20 text-skin-base">
            <Icon name='simple-icons:neovim' class='w-5 h-5 text-green-500'/>
            <span class="font-mono font-bold text-sm text-green-500">./neovim_mode.sh</span>
        </a>

        {/* 5. SKILLS */}
        <div class="rounded-3xl bg-skin-muted sm:bg-skin-button-muted p-5 border border-skin-muted/20">
            <h3 class="font-mono font-bold text-skin-accent mb-4 text-sm border-b border-skin-muted/30 pb-2">:: Skillset</h3>
            <Skills />
        </div>
    </div>

    {/* --- RIGHT COLUMN (Main Content) --- */}
    <div class="flex-1 flex flex-col gap-8">
        <slot /> 
    </div>
  </div>
</Section>
