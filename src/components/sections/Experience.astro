---
import Section from "../Section.astro";
import { work } from "@cv";
---

<Section className={Astro.props.className}>
  <ul class="flex flex-col gap-6">
    {work.map(({ name, position, summary, highlights, url, startDate, endDate }) => {
      const startYear = new Date(startDate).getFullYear();
      const endYear = endDate != null ? new Date(endDate).getFullYear() : "Present";
      const yearRange = `${startYear} - ${endYear}`;

      return (
        <li class="relative">
          <div class="flex flex-col gap-2 border-l-2 border-skin-muted/30 pl-4 py-2">
            
            {/* --- HEADER: Institution (Left) and Date (Right) --- */}
            <header class="flex flex-col sm:flex-row justify-between items-baseline w-full">
              
              <h3 class="text-xl font-mono font-bold text-skin-base mb-1 sm:mb-0">
                {name} â€” {position}
              </h3>
              
              <time class="text-sm font-mono text-skin-muted text-right">
                {yearRange}
              </time>
              
            </header>
            
            {/* --- CONTENT --- */}
            
            {url && (
              <a href={url} target="_blank" class="text-sm text-skin-muted hover:text-skin-accent transition-colors w-max">
                {url.replace('https://', '')}
              </a>
            )}

            <p class="text-sm text-skin-muted">{summary}</p>

            {/* Highlights List */}
            {highlights && (
                <ul class="list-disc list-inside mt-2 space-y-1 text-sm text-skin-muted">
                    {highlights.map(item => (
                        <li class="pl-2">{item}</li>
                    ))}
                </ul>
            )}
            
          </div>
        </li>
      );
    })}
  </ul>
</Section>
